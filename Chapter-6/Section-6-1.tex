\section{单因素实验的方差分析}

\hparagraph{数学模型} 设在实验中，因素 $ A $ 有 $ S $ 个不同水平 $$ A_1, A_2, \cdots, A_s $$
在水平下的实验结果 $ X_j \sim N(\mu_j, \sigma^2) (j = 1, 2, \cdots, s) $ 。
其中 $ \mu_j $ 和 $ \sigma^2 $ 是位置参数。在水平 $ A_j $ 下做 $ n_j $ 次独立实验，得到结果
$$ \begin{array}{|l|llll|}\hline
    \mbox{序号} & A_1 & A_2 & \cdots & A_s \\\hline
    1           & X_{11} & X_{12} & \cdots & X_{1s} \\
    2           & X_{21} & X_{22} & \cdots & X_{2s} \\
    3           & X_{31} & X_{32} & \cdots & X_{3s} \\
    \vdots      & \vdots & \vdots & \ddots & \vdots \\
    n_j         & X_{n_11} & X_{n_22} & \cdots & X_{n_ss} \\\hline
    \mbox{均值} & \bar{X}_{\cdot 1} & \bar{X}_{\cdot 2} & \cdots & \bar{X}_{\cdot s} \\\hline
\end{array} $$
$ X_{1j}, X_{2j}, \cdots, X_{n_jj} $ 是来自总体 $ X_j $ 的容量为 $ n_j $ 的一个样本，其观察值为
$ x_{1j}, x_{2j}, \cdots, x_{n_jj} $ 。检验假设
\begin{align*}
    H_0 &: \mu_1 = \mu_2 = \cdots = \mu_s \\
    H_1 &: \mu_1, \mu_2, \cdots, \mu_n \mbox{不全相等}
\end{align*}
由于 $ X_{ij} $ 相互独立，且 $ X_{ij} \sim N(\mu_j,\sigma^2)(i=1, 2, \cdots, n_j; j = 1, 2, \cdots, s) $ ，
若记 $ \epsilon_{ij} = X_{ij} - \mu_j $ 则 $ \epsilon_{ij} \sim N(0, \sigma^2) $ 且互相独立。
则有
\begin{equation}
    \left\{\begin{array}{l}
        X_{ij} = \mu_j + \epsilon_{ij} \\
        \epsilon_{ij} \sim N(0, \sigma^2)
    \end{array}\right.
\end{equation}
其中，$ i = 1, 2, \cdots, n_j $ ， $ j = 1, 2, \cdots, s $ ， $ \mu_j $ 与 $ \sigma^2 $ 均为未知参数。

\hparagraph{线性可加模型} 令
\begin{equation*}
    \left\{\begin{array}{>{\displaystyle\arraybackslash}l}
        \mu = \frac{1}{n} \sum_{j=1}^{s} n_j \mu_j, \quad i = 1, 2, \cdots, m \\
        \delta_j = \mu_j - \mu , \quad n = \sum_{j=1}^{s} n_j
    \end{array}\right.
\end{equation*}
则 $ \mu $ 是各水平下总体均值的加权平均，称为总平均值；
$ \delta_i $ 代表了第 $ j $ 水平下的总体均值和平均值的差异，称为 $ A_j $ 的效应，满足
$$ \sum_{j=1}^{s} n_j \delta_j = 0 $$
得到
\begin{equation}
    \left\{\begin{array}{D}
        X_{ij} = \mu + \delta_j + \epsilon_{ij} \\
        \sum_{i=1}^{m} n_j \delta_j = 0
    \end{array}\right.
\end{equation}
其中， $ i = 1, 2, \cdots, n_j $ ， $ j = 1, 2, \cdots, s $ ， $ \epsilon_{ij} \sim N(0, \sigma^2) $ 且相互独立。
该模型的等价假设为
\begin{align*}
    H_0 &: \delta_1, \delta_2, \cdots, \delta_s = 0 \\
    H_1 &: \exists j, \delta_j \neq 0
\end{align*}